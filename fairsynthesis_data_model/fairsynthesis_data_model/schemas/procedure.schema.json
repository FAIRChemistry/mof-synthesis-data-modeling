{
  "$defs": {
    "SynthesisEntry": {
      "properties": {
        "Hardware": {
          "$ref": "#/$defs/Hardware"
        },
        "Metadata": {
          "$ref": "#/$defs/Metadata"
        },
        "Procedure": {
          "$ref": "#/$defs/ProcedureWithDifferentSections"
        },
        "Reagents": {
          "$ref": "#/$defs/Reagents"
        }
      },
      "required": [
        "Metadata",
        "Reagents",
        "Procedure"
      ],
      "type": "object"
    },
    "Hardware": {
      "properties": {
        "Component": {
          "items": {
            "$ref": "#/$defs/HardwareComponentsEntry"
          },
          "type": "array"
        }
      },
      "type": "object"
    },
    "HardwareComponentsEntry": {
      "properties": {
        "_chemical": {
          "type": "string"
        },
        "_comment": {
          "type": "string"
        },
        "_id": {
          "type": "string"
        },
        "_type": {
          "type": "string"
        }
      },
      "required": [
        "_id"
      ],
      "type": "object"
    },
    "Metadata": {
      "properties": {
        "_description": {
          "type": "string"
        },
        "_product": {
          "type": "string"
        },
        "_product_inchi": {
          "type": "string"
        }
      },
      "required": [
        "_description"
      ],
      "type": "object"
    },
    "ProcedureWithDifferentSections": {
      "properties": {
        "Prep": {
          "$ref": "#/$defs/StepsFlatProcedure"
        },
        "Reaction": {
          "$ref": "#/$defs/StepsFlatProcedure"
        },
        "Workup": {
          "$ref": "#/$defs/StepsFlatProcedure"
        }
      },
      "title": "Procedure with different sections"
    },
    "StepsFlatProcedure": {
      "properties": {
        "Step": {
          "items": {
            "$ref": "#/$defs/StepEntry"
          },
          "type": "array"
        }
      },
      "required": [
        "Step"
      ],
      "title": "Flat procedure"
    },
    "StepEntry": {
      "required": [
        "$xml_type"
      ],
      "properties": {
        "_vessel": {
          "type": "string"
        },
        "_comment": {
          "type": "string"
        }
      },
      "oneOf": [
        {
          "title": "Add",
          "required": [
            "_reagent",
            "_amount"
          ],
          "properties": {
            "$xml_type": {
              "const": "Add"
            },
            "_reagent": {
              "type": "string",
              "description": "name of the involved chemical as listed in the \"reagents\""
            },
            "_amount": {
              "$ref": "#/$defs/Quantity",
              "description": "amount of the involved chemical"
            }
          }
        },
        {
          "title": "HeatChill",
          "required": [
            "_temp"
          ],
          "properties": {
            "$xml_type": {
              "const": "HeatChill"
            },
            "_temp": {
              "$ref": "#/$defs/Temperature",
              "properties": {
                "Unit": {
                  "const": "celsius"
                },
                "Value": {
                  "minimum": 20
                }
              },
              "type": "object",
              "description": "temperature in the case of HeatChill",
              "title": ""
            },
            "_time": {
              "$ref": "#/$defs/Time",
              "description": "time of the step in the case of HeatChill, Wait, Sonicate, or Dry"
            }
          }
        },
        {
          "title": "EvacuateAndRefill",
          "required": [
            "_gas"
          ],
          "properties": {
            "$xml_type": {
              "const": "EvacuateAndRefill"
            },
            "_gas": {
              "type": "string",
              "const": "Ar",
              "description": "refilling gas in the case of EvacuateAndRefill"
            }
          }
        },
        {
          "title": "WashSolid",
          "required": [
            "_solvent"
          ],
          "properties": {
            "$xml_type": {
              "const": "WashSolid"
            },
            "_solvent": {
              "type": "string",
              "description": "name of the solvent in the case of WashSolid",
              "enum": [
                "CHCl3",
                "DMF",
                "MeOH",
                "acetone",
                "EtOH",
                "NaCl aq",
                "scCO2",
                "MeCN",
                "Et3N",
                "MeOH+scCO2"
              ]
            }
          }
        },
        {
          "title": "Wait",
          "required": [
            "_time"
          ],
          "properties": {
            "$xml_type": {
              "const": "Wait"
            },
            "_time": {
              "$ref": "#/$defs/Time",
              "description": "time of the step in the case of HeatChill, Wait, Sonicate, or Dry"
            }
          }
        },
        {
          "title": "Evaporate",
          "properties": {
            "$xml_type": {
              "const": "Evaporate"
            },
            "_unknown": {
              "description": "Ken please add the corresponding attributes if existing"
            }
          }
        },
        {
          "title": "Sonicate",
          "properties": {
            "$xml_type": {
              "const": "Sonicate"
            },
            "_time": {
              "$ref": "#/$defs/Time",
              "description": "time of the step in the case of HeatChill, Wait, Sonicate, or Dry"
            }
          }
        },
        {
          "required": [
            "_time"
          ],
          "title": "Dry",
          "properties": {
            "$xml_type": {
              "const": "Dry"
            },
            "_time": {
              "$ref": "#/$defs/Time",
              "description": "time of the step in the case of HeatChill, Wait, Sonicate, or Dry"
            },
            "_pressure": {
              "$ref": "#/$defs/Pressure"
            },
            "_temp": {
              "$ref": "#/$defs/Temperature"
            }
          }
        }
      ],
      "title": "Step Entry"
    },
    "Quantity": {
      "title": "Quantity",
      "properties": {
        "Unit": {
          "enum": [
            "microgram",
            "milligram",
            "gram",
            "kilogram",
            "ton",
            "millisecond",
            "second",
            "minute",
            "hour",
            "day",
            "week",
            "kelvin",
            "microlitre",
            "millilitre",
            "centilitre",
            "decilitre",
            "litre",
            "ohm",
            "dimensionless",
            "item",
            "micromole",
            "millimole",
            "mole",
            "celsius",
            "kelvin",
            "millimeter",
            "centimeter",
            "meter",
            "pascal",
            "bar"
          ],
          "type": "string"
        },
        "Value": {
          "type": "number"
        }
      },
      "type": "object"
    },
    "Temperature": {
      "title": "Temperature",
      "$ref": "#/$defs/Quantity",
          "type": "object",
          "properties": {
            "Unit": {
              "const": "celsius"
            },
            "Value": {
              "minimum": -273.15
            }
          }
    },
    "Time": {
      "title": "Time",
      "$ref": "#/$defs/Quantity",
      "properties": {
        "Value": {
          "minimum": 0
        }
      }
    },
    "Pressure": {
      "$ref": "#/$defs/Quantity",
      "title": "Pressure",
      "properties": {
        "Unit": {
          "const": "pascal"
        },
        "Value": {
          "minimum": 0
        }
      }
    },
    "Role": {
      "enum": [
        "substrate",
        "solvent",
        "reagent",
        "acid",
        "activating-agent",
        "base",
        "catalyst",
        "ligand",
        "quenching-agent"
      ],
      "type": "string"
    },
    "Reagents": {
      "properties": {
        "Reagent": {
          "items": {
            "$ref": "#/$defs/ReagentsEntry"
          },
          "type": "array"
        }
      },
      "required": [
        "Reagent"
      ],
      "type": "object"
    },
    "ReagentsEntry": {
      "properties": {
        "_cas": {
          "type": "string"
        },
        "_comment": {
          "type": "string"
        },
        "_id": {
          "type": "string"
        },
        "_inchi": {
          "type": "string"
        },
        "_name": {
          "type": "string"
        },
        "_purity": {
          "type": "string"
        },
        "_role": {
          "$ref": "#/$defs/Role"
        }
      },
      "type": "object"
    }
  },
  "properties": {
    "Synthesis": {
      "items": {
        "$ref": "#/$defs/SynthesisEntry"
      },
      "type": "array"
    }
  },
  "required": [
    "Synthesis"
  ],
  "title": "Procedure",
  "type": "object"
}